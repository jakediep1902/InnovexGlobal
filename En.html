<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INNOVEX GLOBAL</title>
    <link rel="stylesheet" href="style.css">
    <script src="script.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="main-header">
        <div class="logo">
            <!-- <img src="images/logo.jpg" alt="Innovex Global"> -->
        </div>
        <nav class="nav-menu">
            <ul>
                <li><a href="index.html">🏠 Home</a></li>
                <li><a href="sanpham.html">🛒 Products</a></li>
                <li><a href="lienhe.html">📞 Contact</a></li>
            </ul>
        </nav>
        <a href="tel:+84849496767" class="call-button">📞 Call Now</a>
    </header>
    <h1>Innovex Global</h1>
    <p>Technology and Export Solutions</p>
   
    <div class="product-container">
        <!-- Product items will be displayed here -->
    </div>
    
    <footer>
        <a href="#" onclick="checkAdminPassword()">🔑 ADMIN</a>
    </footer>
    <footer>
        <p>&copy; 2024 INNOVEX GLOBAL. All rights reserved.</p>
    </footer>

<script>
const titleID = GetTitleID();
const secretKey = GetSCkey(); // 🔴 REPLACE WITH YOUR SECRET KEY

function checkAdminPassword() {
    const passwordKey = "admin_password_verified";
    const expirationMinutes = 10; // ⏳ Time before requiring re-entry (minutes)

    const lastVerifiedTime = localStorage.getItem(passwordKey);
    const currentTime = new Date().getTime();

    if (lastVerifiedTime && currentTime - lastVerifiedTime < expirationMinutes * 60 * 1000) {
        window.location.href = "admin.html";
        return;
    }

    let password = prompt("Enter ADMIN password:");
    if (password === "123456") {  // 🔑 Replace "123456" with the actual password
        localStorage.setItem(passwordKey, currentTime);
        window.location.href = "admin.html";
    } else if (password !== null) {
        alert("Incorrect password! Please try again.");
    }
}

async function getPrice() {
    const url = `https://${titleID}.playfabapi.com/Admin/GetTitleData`;
    
    try {
        const response = await fetch(url, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "X-SecretKey": secretKey
            },
            body: JSON.stringify({})
        });

        const result = await response.json();
        console.log("📡 Data from PlayFab:", result);

        if (response.ok) {
            updateProductList(result.data.Data);
        } else {
            console.error("❌ Error loading data:", result.errorMessage);
        }
    } catch (error) {
        console.error("❌ Connection error:", error);
    }
}

const EXCHANGE_RATE = 0.00004; // Ví dụ: 1 VNĐ = 0.00004 USD (~ 25,000 VNĐ/USD)

function updateProductList(data) {
    const productList = document.querySelector(".product-container");

    if (!productList) {
        console.error("❌ ERROR: .product-container not found!");
        return;
    }

    for (const key in data) {
        if (data.hasOwnProperty(key)) {
            try {
                const productData = JSON.parse(data[key]);
                let priceVND = productData.price !== undefined ? Number(productData.price) : 0;
                let priceUSDPerTon = (priceVND * EXCHANGE_RATE * 1000).toFixed(2); // Chuyển sang USD/tons
                priceUSDPerTon = Math.round(priceVND * EXCHANGE_RATE * 1000); // Làm tròn về số nguyên


                const imageUrl = productData.image || "https://via.placeholder.com/150";
                const productName = key.charAt(0).toUpperCase() + key.slice(1);

                let existingProduct = document.querySelector(`.product[data-name="${key}"]`);

                if (existingProduct) {
                    console.log("🔄 Updating product:", key);
                    existingProduct.querySelector(".price").innerText = `Price: $${priceUSDPerTon}/tons`;
                    existingProduct.querySelector("img").src = imageUrl;
                } else {
                    console.log("➕ Adding new product:", key);
                    const productDiv = document.createElement("div");
                    productDiv.classList.add("product");
                    productDiv.dataset.name = key;
                    productDiv.innerHTML = `
                        <img src="${imageUrl}" alt="${productName}">
                        <h3>${productName}</h3>
                        <p class="price">Price: $${priceUSDPerTon}/tons</p>
                    `;
                    productList.appendChild(productDiv);
                }
            } catch (error) {
                console.error(`❌ Error processing product "${key}":`, error);
            }
        }
    }
}



document.addEventListener("DOMContentLoaded", () => {
    getPrice();
    setInterval(getPrice, 50000);
});
</script>

<div class="container">
    <a href="tel:+84849496767" class="button">📞 Contact: Mr. Dương - Jake</a>
    <a href="https://zalo.me/0906654867" class="button">💬 Message Zalo</a>
    <a href="https://wa.me/84849496767" class="button">💬 Chat on WhatsApp</a>
    <a href="index.html" class="button">Tiếng Việt</a>
</div>
</body>
</html>
